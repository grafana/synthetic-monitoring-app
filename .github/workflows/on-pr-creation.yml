name: On creating a PR

on:
  pull_request:

jobs:
  linting-and-tests:
    name: Linting and Tests
    permissions:
      contents: read
      attestations: write
    uses: ./.github/workflows/call_validate.yml

  policy-bot:
    name: Policy Bot
    permissions:
      contents: read
      id-token: write
    uses: ./.github/workflows/call_policy-check.yml

  danger-js:
    name: DangerJS
    needs: linting-and-tests
    permissions:
      pull-requests: write
      attestations: read
      contents: read
    # if: github.event_name == 'pull_request' && github.base_ref == 'main'
    uses: ./.github/workflows/call_dangerJS.yml
